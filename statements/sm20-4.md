|                      |       |
|----------------------|-------|
| **Time limit:**      | `1 s` |
| **Real time limit:** | `1 s` |
| **Memory limit:**    | `64M` |


### Problem sm20-4: unix/socket/server-2

В аргументах командной строки задается номер порта PORT и
некоторый строковый параметр KEY. Программа должна слушать
входящие TCP-соединения на порту PORT. Для каждого
подключающегося клиента создается отдельный процесс,
взаимодействующий с этим клиентом, а отец продолжает ожидать
подключений.

Взаимодействие клиента и сервера выполняется в текстовом виде, в
конце каждого элемента протокола передается пара символов \r\n.
Длина элемента протокола включая символы \r\n не превышает 255
байт.

Каждому подключившемуся клиенту пересылается сначала строка KEY,
затем порядковый номер клиента SERIAL, начинающийся с 1, то есть
первый клиент получает номер 1, второй 2, третий 3 и т. д. Номера
клиентов не должны повторяться. Клиент отправляет серверу
положительное 32-битное целое число MAX. В ответ сервер
отправляет клиенту то же самое число MAX.

Далее выполняется цикл обмена клиента и сервера. На каждой
итерации цикла клиент пересылает серверу положительное 32-битное
целое число NUM. Если NUM > MAX или NUM + SERIAL не представим
32-битным знаковым целым типом, сервер пересылает клиенту число
-1 и закрывает соединение. В противном случае сервер пересылает
клиенту число NUM + SERIAL. Клиент может закрыть соединение в
любой момент времени.

Если сервер получает сигнал SIGTERM, должны быть закрыты
соединения со всеми подключенными в данный момент клиентами.
Родитель завершается с кодом завершения 0 после завершения всех
процессов, созданных для взаимодействия с клиентами.

Предполагайте, что клиент строго соблюдает протокол
взаимодействия.

Не забывайте устанавливать опции SO_REUSEADDR и SO_REUSEPORT!

Ошибка Presentation Error означает нарушение протокола
взаимодействия со стороны сервера, которое было распознано
клиентом.

