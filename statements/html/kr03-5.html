<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <table border="1">
   <tr>
    <td>
     <b>
      Time limit:
     </b>
    </td>
    <td>
     <tt>
      1 s
     </tt>
    </td>
   </tr>
   <tr>
    <td>
     <b>
      Real time limit:
     </b>
    </td>
    <td>
     <tt>
      5 s
     </tt>
    </td>
   </tr>
   <tr>
    <td>
     <b>
      Memory limit:
     </b>
    </td>
    <td>
     <tt>
      64M
     </tt>
    </td>
   </tr>
  </table>
  <h3>
   Problem kr03-5: kr03-5
  </h3>
  <p>
   Пусть дана строка
   <i>
    S
   </i>
   длины
   <i>
    N
   </i>
   .
Символы строки нумеруются, как обычно, от 0, то есть
   <i>
    S
   </i>
   [0] ...
   <i>
    S
   </i>
   [
   <i>
    N
   </i>
   −1].
  </p>
  <p>
   <i>
    Преобразование Барроуза-Уилера
   </i>
   (Burrows-Wheeler Transform) над
строкой
   <i>
    S
   </i>
   можно определить следующим образом.
Добавим к строке специальный символ-терминатор, который обозначим знаком '#'.
Этот символ
   <b>
    лексикографически больше
   </b>
   всех допустимых символов.
Рассмотрим все возможные циклические сдвиги данной строки,
запишем их в лексикографическом порядке одну под другой.
Получим матрицу размера
   <i>
    N+1
   </i>
   ×
   <i>
    N+1
   </i>
   .
Возьмём в этой матрице последний столбец, он и будет искомой строкой.
Например, рассмотрим строку
   <tt>
    бананарама
   </tt>
   . Матрица сдвигов:
  </p>
  <pre>
бананарама#
ананарама#б
нанарама#ба
анарама#бан
нарама#бана
арама#банан
рама#банана
ама#бананар
ма#бананара
а#бананарам
#бананарама
</pre>
  <p>
   Сортируем ее лексикографически:
  </p>
  <pre>
ама#бананар
ананарама#б
анарама#бан
арама#банан
а#бананарам
бананарама#
ма#бананара
нанарама#ба
нарама#бана
рама#банана
#бананарама
</pre>
  <p>
   Берем последний столбец, и в результате получим строку
   <tt>
    рбннм#ааааа
   </tt>
   .
  </p>
  <p>
   На стандартном потоке ввода подается текст,
обязательно содержащий единственное вхождение символа ‘#’.
Во вводимом тексте игнорируются пробельные символы,
а все непробельные символы и ‘#’ рассматриваются
как результат выполненного BWT-преобразования.
Предполагая, что ‘#’ заменяет специальный символ-терминатор,
который лексикографически больше любого другого символа,
восстановите исходную строку и
выведите ее на стандартный поток вывода без ‘#’.
Вывод завершайте переходом на новую строку.
  </p>
  <p>
   Используйте wide character API
  </p>
  <h3>
   Examples
  </h3>
  <h4>
   Input
  </h4>
  <pre>рбннм#ааааа</pre>
  <h4>
   Output
  </h4>
  <pre>бананарама</pre>
 </body>
</html>